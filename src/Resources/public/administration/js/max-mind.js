!function(){var e={989:function(){},140:function(e,t,n){var r=n(989);r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals),(0,n(534).A)("b7eb03dc",r,!0,{})},534:function(e,t,n){"use strict";function r(e,t){for(var n=[],r={},s=0;s<t.length;s++){var a=t[s],i=a[0],o={id:e+":"+s,css:a[1],media:a[2],sourceMap:a[3]};r[i]?r[i].parts.push(o):n.push(r[i]={id:i,parts:[o]})}return n}n.d(t,{A:function(){return h}});var s,a="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!a)throw Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},o=a&&(document.head||document.getElementsByTagName("head")[0]),d=null,c=0,l=!1,u=function(){},m=null,p="data-vue-ssr-id",g="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function h(e,t,n,s){l=n,m=s||{};var a=r(e,t);return f(a),function(t){for(var n=[],s=0;s<a.length;s++){var o=i[a[s].id];o.refs--,n.push(o)}t?f(a=r(e,t)):a=[];for(var s=0;s<n.length;s++){var o=n[s];if(0===o.refs){for(var d=0;d<o.parts.length;d++)o.parts[d]();delete i[o.id]}}}}function f(e){for(var t=0;t<e.length;t++){var n=e[t],r=i[n.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](n.parts[s]);for(;s<n.parts.length;s++)r.parts.push(w(n.parts[s]));r.parts.length>n.parts.length&&(r.parts.length=n.parts.length)}else{for(var a=[],s=0;s<n.parts.length;s++)a.push(w(n.parts[s]));i[n.id]={id:n.id,refs:1,parts:a}}}}function v(){var e=document.createElement("style");return e.type="text/css",o.appendChild(e),e}function w(e){var t,n,r=document.querySelector("style["+p+'~="'+e.id+'"]');if(r){if(l)return u;r.parentNode.removeChild(r)}if(g){var s=c++;t=S.bind(null,r=d||(d=v()),s,!1),n=S.bind(null,r,s,!0)}else t=x.bind(null,r=v()),n=function(){r.parentNode.removeChild(r)};return t(e),function(r){r?(r.css!==e.css||r.media!==e.media||r.sourceMap!==e.sourceMap)&&t(e=r):n()}}var _=(s=[],function(e,t){return s[e]=t,s.filter(Boolean).join("\n")});function S(e,t,n,r){var s=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=_(t,s);else{var a=document.createTextNode(s),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(a,i[t]):e.appendChild(a)}}function x(e,t){var n=t.css,r=t.media,s=t.sourceMap;if(r&&e.setAttribute("media",r),m.ssrId&&e.setAttribute(p,t.id),s&&(n+="\n/*# sourceURL="+s.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var a=t[r]={id:r,exports:{}};return e[r](a,a.exports,n),a.exports}n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="bundles/maxmind/",window?.__sw__?.assetPath&&(n.p=window.__sw__.assetPath+"/bundles/maxmind/"),function(){"use strict";let{Component:e}=Shopware;e.override("sw-order-list",{template:'                {% block sw_order_list_grid_columns_delivery_address %}\n                <template #column-deliveries.id="{ item }">\n                    <template v-if="item.deliveries && item.deliveries[0] && item.deliveries[0].shippingOrderAddress">\n                        <div\n                            v-tooltip="{\n                                showDelay: 300,\n                                width: 400,\n                                disabled: item.deliveries.length <= 1,\n                                message: deliveryTooltip(item.deliveries)\n                            }"\n                            class="sw-order-list__delivery_address">\n                            {{ item.deliveries[0].shippingOrderAddress.street }},\n                            {{ item.deliveries[0].shippingOrderAddress.city }},\n                            {{ getStateNameById(item.deliveries[0].shippingOrderAddress.countryStateId) }},\n\n                            {{ item.deliveries[0].shippingOrderAddress.zipcode }}\n                        </div>\n                    </template>\n                </template>\n                {% endblock %}\n                {% block sw_order_list_grid_columns_amount %}\n                    <template #column-amountTotal="{ item }">\n                        {{ (item.amountTotal).toFixed(2) }} {{ item.currency.translated.shortName }}\n                    </template>\n                {% endblock %}',inject:["repositoryFactory"],data(){return{loadedStates:{}}},watch:{orders:{handler(){this.loadCountryStates()},immediate:!0,deep:!0}},computed:{orderColumns(){let e=this.$super("orderColumns");return e.push({property:"customFields.maxmind_fraud_risk",label:"Fraud Risk Score",allowResize:!0,align:"right",sortable:!0,rawData:!0,renderer(e,t){let n=t?.customFields?.maxmind_fraud_risk;return null!=n?parseFloat(n):"-"}}),e}},methods:{async loadCountryStates(){let e=this.repositoryFactory.create("country_state"),t=[...new Set((this.orders||[]).map(e=>e?.deliveries?.[0]?.shippingOrderAddress?.countryStateId).filter(Boolean))];if(!t.length)return;let n=new Shopware.Data.Criteria(1,100);n.addFilter(Shopware.Data.Criteria.equalsAny("id",t));try{let t=await e.search(n);this.loadedStates=t.reduce((e,t)=>(e[t.id]=t,e),{})}catch(e){console.error("Failed to load country states:",e)}},getStateNameById(e){return this.loadedStates?.[e]?.name??""}}}),Shopware.Component.override("sw-order-detail-general",{template:'{% block sw_order_detail_general %}\n    <sw-card v-if="hasMaxMindData">\n        <div class="sw-order-detail-general__maxmind-risk-scores">\n            <span class="h2">\n                {{ $tc(\'sw-order-detail-general.maxmindRiskScores.title\') }}\n            </span>\n\n            <div class="sw-order-detail-general__maxmind-scores">\n                <div class="sw-order-detail-general__maxmind-score">\n                    <strong>{{ $tc(\'sw-order-detail-general.maxmindRiskScores.fraudRisk\') }}</strong>\n                    <span>{{ fraudScore }}</span>\n                </div>\n                <div class="sw-order-detail-general__maxmind-score">\n                    <strong>{{ $tc(\'sw-order-detail-general.maxmindRiskScores.overallRiskScore\') }}</strong>\n                    <span>{{ overallRiskScore }}</span>\n                </div>\n                <div class="sw-order-detail-general__maxmind-score">\n                    <strong>{{ $tc(\'sw-order-detail-general.maxmindRiskScores.ipRiskScore\') }}</strong>\n                    <span>{{ ipRiskScore }}</span>\n                </div>\n            </div>\n\n            <div class="sw-order-detail-general__maxmind-actions">\n                <sw-button\n                    variant="primary"\n                    @click="openMaxMind"\n                >\n                    {{ $tc(\'sw-order-detail-general.maxmindFraudDetection.viewInMaxMind\') }}\n                </sw-button>\n\n\n                <sw-button\n                        variant="secondary"\n                        :disabled="!transactionId"\n                        @click="copyTransactionId"\n                >\n                    {{ $tc(\'sw-order-detail-general.maxmindFraudDetection.copyTransactionId\') }}\n                </sw-button>\n\n                <sw-button\n                        variant="secondary"\n                        :disabled="!warningsFactors.length"\n                        @click="toggleWarningsFactors"\n                >\n                    {{ $tc(\'sw-order-detail-general.maxmindFraudDetection.viewWarningsFactors\') }}\n                </sw-button>\n            </div>\n\n            <div v-if="showWarningsFactors" class="sw-order-detail-general__maxmind-warnings-factors">\n                <ul>\n                    <li v-for="factor in warningsFactors" :key="factor">{{ factor }}</li>\n                </ul>\n            </div>\n        </div>\n    </sw-card>\n\n    {% parent() %}\n{% endblock %}\n',data(){return{showWarningsFactors:!1}},computed:{fraudScore(){return this.order?.customFields&&void 0!==this.order.customFields.maxmind_fraud_risk?this.order.customFields.maxmind_fraud_risk:"N/A"},overallRiskScore(){return this.order?.customFields?.maxmind_overall_risk_score||"N/A"},ipRiskScore(){return this.order?.customFields?.maxmind_ip_risk_score||"N/A"},transactionId(){return this.order?.customFields?.maxmind_transaction_id||""},transactionUrl(){return this.order?.customFields?.maxmind_transaction_url||"#"},warningsFactors(){let e=this.order?.customFields?.maxmind_warnings_factors||[];return Array.isArray(e)?e:[]},hasMaxMindData(){return"N/A"!==this.fraudScore||"N/A"!==this.overallRiskScore||"N/A"!==this.ipRiskScore||this.transactionId||"#"!==this.transactionUrl||this.warningsFactors.length>0}},methods:{openMaxMind(){this.transactionUrl&&"#"!==this.transactionUrl?window.top.open(this.transactionUrl,"_blank"):this.createNotificationError({title:"MaxMind",message:"No valid transaction URL found."})},copyTransactionId(){if(!this.transactionId){this.createNotificationError({message:this.$tc("sw-order-detail-general.maxmindFraudDetection.noTransactionId")});return}navigator.clipboard.writeText(this.transactionId).then(()=>{this.createNotificationSuccess({message:this.$tc("sw-order-detail-general.maxmindFraudDetection.transactionIdCopied")})}).catch(()=>{this.createNotificationError({message:this.$tc("sw-order-detail-general.maxmindFraudDetection.copyFailed")})})},toggleWarningsFactors(){this.showWarningsFactors=!this.showWarningsFactors}}}),Shopware.Component.override("sw-order-list",{template:'{% block sw_order_list_grid_columns_state %}\n    <template #column-stateMachineState.name="{ item }">\n        <div class="sw-order-list__state">\n            <sw-color-badge\n                :color="getVariantFromOrderState(item)"\n                :class="getStatusBadgeClass(item.stateMachineState.technicalName)"\n                rounded\n            />\n            {{ item.stateMachineState.translated.name }}\n        </div>\n    </template>\n{% endblock %}',methods:{getStatusBadgeClass(e){switch(e){case"fraud_pass":return"sw-color-badge--fraud-pass";case"fraud_review":return"sw-color-badge--fraud-review";case"fraud_fail":return"sw-color-badge--fraud-fail";case"in_progress":return"sw-color-badge--in-progress";case"completed":return"sw-color-badge--completed";case"cancelled":return"sw-color-badge--cancelled";default:return""}},getVariantFromOrderState(e){switch(e.stateMachineState.technicalName){case"in_progress":case"fraud_review":return"primary";case"completed":case"fraud_pass":return"success";case"cancelled":case"fraud_fail":return"danger";default:return"neutral"}}}}),Shopware.Component.override("sw-order-general-info",{template:'{% block sw_order_detail_base_general_info_order_states_order %}\n    <div class="sw-order-general-info__order-state">\n        <sw-order-state-select-v2\n            v-tooltip="{\n                message: $tc(\'sw-privileges.tooltip.warning\'),\n                disabled: acl.can(\'order.editor\'),\n                showOnDisabledElements: true\n            }"\n            class="sw-order-general-info__order-state-order"\n            :class="getBackgroundStyle()"\n            :transition-options="orderStateOptions"\n            rounded-style\n            state-type="order"\n            :placeholder="order.stateMachineState.translated.name"\n            :label="$tc(\'sw-order.stateCard.headlineOrderState\')"\n            :disabled="!acl.can(\'order.editor\')"\n            @state-select="onStateSelected"\n        />\n    </div>\n{% endblock %}',methods:{getBackgroundStyle(){switch(this.order.stateMachineState.technicalName){case"in_progress":case"fraud_review":return"sw-order-state__progress-select";case"completed":case"fraud_pass":return"sw-order-state__completed-select";case"cancelled":case"fraud_fail":return"sw-order-state__cancelled-select";default:return"sw-order-state__open-select"}}}}),n(140);var t=JSON.parse('{"sw-order-detail-general":{"maxmindRiskScores":{"title":"MaxMind Risk Scores","fraudRisk":"Fraud Risk Score","overallRiskScore":"Overall Risk Score","ipRiskScore":"IP Address Risk Score"},"maxmindFraudDetection":{"title":"MaxMind Fraud Detection","viewInMaxMind":"View in MaxMind","copyTransactionId":"Copy Transaction ID","viewWarningsFactors":"View Warnings & Factors","noTransactionId":"No Transaction ID available.","transactionIdCopied":"Transaction ID copied to clipboard!","copyFailed":"Failed to copy Transaction ID."},"fraud-risk-score":{"title":"Fraud Risk Score"}},"solu1-maxmind-config":{"apiTest":{"button":"Test API Connection","successTitle":"Connection successful","successMessage":"The MaxMind credentials are valid.","errorTitle":"Connection failed","errorMessage":"The connection test failed.","missingCredentials":"Please enter your Account ID and License Key before running the test."}}}'),r=JSON.parse('{"sw-order-detail-general":{"maxmindRiskScores":{"title":"MaxMind Risikobewertungen","fraudRisk":"Betrugsrisiko","overallRiskScore":"Gesamtrisiko","ipRiskScore":"IP-Adressrisiko"},"maxmindFraudDetection":{"title":"MaxMind Betrugserkennung","viewInMaxMind":"In MaxMind anzeigen","copyTransactionId":"Transaktions-ID kopieren","viewWarningsFactors":"Warnungen & Faktoren anzeigen","noTransactionId":"Keine Transaktions-ID verf\xfcgbar.","transactionIdCopied":"Transaktions-ID wurde in die Zwischenablage kopiert!","copyFailed":"Kopieren der Transaktions-ID fehlgeschlagen."},"fraud-risk-score":{"title":"Betrugsrisiko-Score Test"}},"solu1-maxmind-config":{"apiTest":{"button":"API-Verbindung testen","successTitle":"Verbindung erfolgreich","successMessage":"Die MaxMind-Zugangsdaten sind g\xfcltig.","errorTitle":"Verbindung fehlgeschlagen","errorMessage":"Der Verbindungstest ist fehlgeschlagen.","missingCredentials":"Bitte geben Sie Account-ID und Lizenzschl\xfcssel ein, bevor Sie den Test starten."}}}');let{Component:s,Mixin:a}=Shopware;s.register("maxmind-api-test",{template:'{% block solu1_maxmind_api_test_button %}\n    <div class="solu1-maxmind-api-test">\n        <sw-button-process\n            :is-loading="isLoading"\n            :process-success="isSaveSuccessful"\n            @process-finish="onProcessFinish"\n            @click="checkConnection"\n        >\n            {{ $tc(\'solu1-maxmind-config.apiTest.button\') }}\n        </sw-button-process>\n    </div>\n{% endblock %}\n',inject:["MaxMindApiTestService"],mixins:[a.getByName("notification")],data(){return{isLoading:!1,isSaveSuccessful:!1}},computed:{pluginConfig(){let e=this.getConfigParent();if(!e||!e.actualConfigData)return{};let t=this.getCurrentSalesChannelId()??"null";return e.actualConfigData[t]??e.actualConfigData.null??{}}},methods:{onProcessFinish(){this.isSaveSuccessful=!1},getConfigParent(){let e=this.$parent;for(;e&&void 0===e.actualConfigData;)e=e.$parent;return e??null},getCurrentSalesChannelId(){let e=this.$parent;for(;e&&void 0===e.currentSalesChannelId;)e=e.$parent;return e?e.currentSalesChannelId:null},buildPayload(){let e=this.pluginConfig;return{accountId:e["MaxMind.config.MaxMindConfigAccountId"]??e.MaxMindConfigAccountId??null,licenseKey:e["MaxMind.config.MaxMindConfigLicenseKey"]??e.MaxMindConfigLicenseKey??null,salesChannelId:this.getCurrentSalesChannelId()}},checkConnection(){let e=this.buildPayload();if(!e.accountId||!e.licenseKey){this.createNotificationError({title:this.$tc("solu1-maxmind-config.apiTest.errorTitle"),message:this.$tc("solu1-maxmind-config.apiTest.missingCredentials")});return}this.isLoading=!0,this.MaxMindApiTestService.check(e).then(e=>{if(e?.success){this.isSaveSuccessful=!0,this.createNotificationSuccess({title:this.$tc("solu1-maxmind-config.apiTest.successTitle"),message:e.message??this.$tc("solu1-maxmind-config.apiTest.successMessage")});return}this.createNotificationError({title:this.$tc("solu1-maxmind-config.apiTest.errorTitle"),message:e?.message??this.$tc("solu1-maxmind-config.apiTest.errorMessage")})}).catch(e=>{let t=e?.response?.data?.message??e?.message??"";this.createNotificationError({title:this.$tc("solu1-maxmind-config.apiTest.errorTitle"),message:t||this.$tc("solu1-maxmind-config.apiTest.errorMessage")})}).finally(()=>{this.isLoading=!1})}}});let{ApiService:i}=Shopware.Classes;var o=class extends i{constructor(e,t,n="solu1-maxmind/test-connection"){super(e,t,n)}check(e={}){let t=this.getBasicHeaders();return this.httpClient.post(`_action/${this.getApiBasePath()}`,e,{headers:t}).then(e=>i.handleResponse(e))}};Shopware.Locale.extend("en-GB",t),Shopware.Locale.extend("de-DE",r),Shopware.Service().register("MaxMindApiTestService",()=>new o(Shopware.Application.getContainer("init").httpClient,Shopware.Service("loginService")))}()}();